<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Loaders - VoDEx Docs</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../assets/_mkdocstrings.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">VoDEx Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../tutorials/" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../how-to-guides/" class="nav-link">How-To Guides</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../reference/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Loaders</a>
</li>
                                    
<li>
    <a href="../core/" class="dropdown-item">Core</a>
</li>
                                    
<li>
    <a href="../dbmethods/" class="dropdown-item">DataBase methods</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../explanation/" class="nav-link">Explanation</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../reference/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../core/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#vodexloaders-module" class="nav-link">vodex.loaders module</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#src.vodex.loaders" class="nav-link">src.vodex.loaders</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#src.vodex.loaders.ImageLoader" class="nav-link">ImageLoader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#src.vodex.loaders.TiffLoader" class="nav-link">TiffLoader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="vodexloaders-module">vodex.loaders module</h1>


<div class="doc doc-object doc-module">


<a id="src.vodex.loaders"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains classes to load and collect information from the imaging data.</p>
<p>The module contains the following classes:</p>
<ul>
<li>
<p><code>TiffLoader</code> - A class to work with tiff image files.
It is used to get the datatype of the images, get the number of frames in each tiff file and load frames from tiff files.
You can create your own loaders to work with other file types.</p>
</li>
<li>
<p><code>ImageLoader</code> - Chooses appropriate loader based on the type of the imaging files,
collects information about the datatype, number of frames per file and loads data from files.</p>
</li>
</ul>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="src.vodex.loaders.ImageLoader" class="doc doc-heading">
        <code>ImageLoader</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Chooses appropriate loader based on the type of the imaging files,
collects information about the datatype, number of frames per file and loads data from files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_example</code></td>
          <td>
          </td>
          <td><p>the path to a file example (one file from the whole dataaset).
needed to get file type and initialise the corresponding data loader.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>loader_map</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, type]</code>
          </td>
          <td><p>a dictionary that maps the file extensions to their loaders.</p></td>
        </tr>
        <tr>
          <td><code>supported_extension</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>list of all the supported file extensions.</p></td>
        </tr>
        <tr>
          <td><code>file_extension</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>the file extension of the provided file example.</p></td>
        </tr>
        <tr>
          <td><code>loader</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="tifffile.TiffFile">TiffFile</span>]</code>
          </td>
          <td><p>a loader class initialised using the file example.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>src\vodex\loaders.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ImageLoader</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chooses appropriate loader based on the type of the imaging files,</span>
<span class="sd">    collects information about the datatype, number of frames per file and loads data from files.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_example : the path to a file example (one file from the whole dataaset).</span>
<span class="sd">            needed to get file type and initialise the corresponding data loader.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        loader_map: a dictionary that maps the file extensions to their loaders.</span>
<span class="sd">        supported_extension (List[str]): list of all the supported file extensions.</span>
<span class="sd">        file_extension (str): the file extension of the provided file example.</span>
<span class="sd">        loader: a loader class initialised using the file example.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_example</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>

        <span class="c1"># A list of supported formats. Create mapping from file formats to loaders.</span>
        <span class="c1"># (Currently only supports files with tif extensions)</span>
        <span class="c1"># Expand this dictionary to add support for other file formats.</span>
        <span class="c1"># 1. *.tif and *.tiff support is implemented using tifffile package</span>
        <span class="c1"># 2. ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loader_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;.tif&quot;</span><span class="p">:</span> <span class="n">TiffLoader</span><span class="p">,</span>
                                            <span class="s2">&quot;.tiff&quot;</span><span class="p">:</span> <span class="n">TiffLoader</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">supported_extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c1"># Right now everything we need to initialise a TiffLoader we can get from one example file:</span>
        <span class="c1"># file extension and the size and data type of one frame.</span>
        <span class="c1"># If you are adding a custom loader and it needs access to the whole recording</span>
        <span class="c1"># or manual input for initialisation or a config file ... or anything else,</span>
        <span class="c1"># you need to change the initialisation of the ImageClass as well.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span> <span class="o">=</span> <span class="n">file_example</span><span class="o">.</span><span class="n">suffix</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">supported_extension</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;Only files with the following extensions are supported: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">supported_extension</span><span class="si">}</span><span class="s2">, but&quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span><span class="si">}</span><span class="s2"> was given&quot;</span>

        <span class="c1"># Pick the loader and initialise it with the data directory:</span>
        <span class="c1"># chooses the proper loader based on the files extension.</span>
        <span class="c1"># Add your class to name to the supported variable types when adding support to other file formats.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TiffFile</span><span class="p">,</span> <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span><span class="p">](</span><span class="n">file_example</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ImageLoader</span><span class="p">):</span>
            <span class="n">is_same</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">supported_extension</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">supported_extension</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">file_extension</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">file_extension</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loader</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">loader</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">is_same</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;__eq__ is Not Implemented for </span><span class="si">{</span><span class="n">ImageLoader</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">def</span> <span class="nf">get_frames_in_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates and returns the number of frames in a given file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_name: the name of the file to get the number of frames for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            the number of frames in the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">get_frames_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_frame_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets frame size ( height , width ) from an image files.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_name: the path to the file to get the size of the frame for.</span>
<span class="sd">        Returns:</span>
<span class="sd">            ( height , width ) height and width of an individual frame in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">get_frame_size</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                    <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads specified frames from specified files.</span>

<span class="sd">        Args:</span>
<span class="sd">            frames: list of frames IN FILES to load.</span>
<span class="sd">            files: a file for every frame</span>
<span class="sd">            show_file_names: whether to print the names of the files from which the frames are loaded.</span>
<span class="sd">                Setting it to True will turn off show_progress.</span>
<span class="sd">            show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">                Won&#39;t have effect of show_file_names is True.</span>
<span class="sd">        Returns:</span>
<span class="sd">            3D array of shape (n_frames, height, width)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span>
                                       <span class="n">show_file_names</span><span class="o">=</span><span class="n">show_file_names</span><span class="p">,</span>
                                       <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">frame_in_file</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
                     <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                     <span class="n">volumes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
                     <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads specified frames from specified files and shapes them into volumes.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_in_file: list of frames IN FILES to load</span>
<span class="sd">                (relative to the beginning of the file from which you are loading).</span>
<span class="sd">            files: a file for every frame</span>
<span class="sd">            volumes: a volume for every frame where that frame belongs</span>
<span class="sd">            show_file_names: whether to print the names of the files from which the frames are loaded.</span>
<span class="sd">                                Setting it to True will turn off show_progress.</span>
<span class="sd">            show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">                Won&#39;t have effect of show_file_names is True.</span>
<span class="sd">        Returns:</span>
<span class="sd">            4D array of shape (number of volumes, zslices, height, width)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO : do I need to check anything else here???</span>
        <span class="c1">#  Like that the frames are in increasing order per file</span>
        <span class="c1">#  ( maybe not here but in the experiment ,</span>
        <span class="c1">#       before we turn them into frames_in_file )</span>
        <span class="c1"># get frames and info</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">frame_in_file</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span>
                                         <span class="n">show_file_names</span><span class="o">=</span><span class="n">show_file_names</span><span class="p">,</span>
                                         <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span>
        <span class="n">n_frames</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># get volume information</span>
        <span class="n">i_volume</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">volumes</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># you can use this method to load portions of the volumes, so fpv will be smaller</span>
        <span class="n">n_volumes</span><span class="p">,</span> <span class="n">fpv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i_volume</span><span class="p">),</span> <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">fpv</span><span class="p">),</span> <span class="s2">&quot;Can&#39;t have different number of frames per volume!&quot;</span>

        <span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_volumes</span><span class="p">,</span> <span class="n">fpv</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">frames</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.ImageLoader.get_frame_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frame_size</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets frame size ( height , width ) from an image files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_name</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>the path to the file to get the size of the frame for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td><p>( height , width ) height and width of an individual frame in pixels.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_frame_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets frame size ( height , width ) from an image files.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_name: the path to the file to get the size of the frame for.</span>
<span class="sd">    Returns:</span>
<span class="sd">        ( height , width ) height and width of an individual frame in pixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">get_frame_size</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.ImageLoader.get_frames_in_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frames_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculates and returns the number of frames in a given file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_name</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>the name of the file to get the number of frames for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of frames in the file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_frames_in_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates and returns the number of frames in a given file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_name: the name of the file to get the number of frames for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        the number of frames in the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">get_frames_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.ImageLoader.load_frames" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">show_file_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Loads specified frames from specified files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>frames</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>list of frames IN FILES to load.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>files</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]</code>
          </td>
          <td><p>a file for every frame</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>show_file_names</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to print the names of the files from which the frames are loaded.
Setting it to True will turn off show_progress.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>show_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to show the progress bar of how many frames have been loaded.
Won't have effect of show_file_names is True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>3D array of shape (n_frames, height, width)</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads specified frames from specified files.</span>

<span class="sd">    Args:</span>
<span class="sd">        frames: list of frames IN FILES to load.</span>
<span class="sd">        files: a file for every frame</span>
<span class="sd">        show_file_names: whether to print the names of the files from which the frames are loaded.</span>
<span class="sd">            Setting it to True will turn off show_progress.</span>
<span class="sd">        show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">            Won&#39;t have effect of show_file_names is True.</span>
<span class="sd">    Returns:</span>
<span class="sd">        3D array of shape (n_frames, height, width)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span>
                                   <span class="n">show_file_names</span><span class="o">=</span><span class="n">show_file_names</span><span class="p">,</span>
                                   <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.ImageLoader.load_volumes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_volumes</span><span class="p">(</span><span class="n">frame_in_file</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">volumes</span><span class="p">,</span> <span class="n">show_file_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Loads specified frames from specified files and shapes them into volumes.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>frame_in_file</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>list of frames IN FILES to load
(relative to the beginning of the file from which you are loading).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>files</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]</code>
          </td>
          <td><p>a file for every frame</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>volumes</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>a volume for every frame where that frame belongs</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>show_file_names</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to print the names of the files from which the frames are loaded.
                Setting it to True will turn off show_progress.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>show_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to show the progress bar of how many frames have been loaded.
Won't have effect of show_file_names is True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>4D array of shape (number of volumes, zslices, height, width)</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_volumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">frame_in_file</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
                 <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                 <span class="n">volumes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
                 <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads specified frames from specified files and shapes them into volumes.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_in_file: list of frames IN FILES to load</span>
<span class="sd">            (relative to the beginning of the file from which you are loading).</span>
<span class="sd">        files: a file for every frame</span>
<span class="sd">        volumes: a volume for every frame where that frame belongs</span>
<span class="sd">        show_file_names: whether to print the names of the files from which the frames are loaded.</span>
<span class="sd">                            Setting it to True will turn off show_progress.</span>
<span class="sd">        show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">            Won&#39;t have effect of show_file_names is True.</span>
<span class="sd">    Returns:</span>
<span class="sd">        4D array of shape (number of volumes, zslices, height, width)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : do I need to check anything else here???</span>
    <span class="c1">#  Like that the frames are in increasing order per file</span>
    <span class="c1">#  ( maybe not here but in the experiment ,</span>
    <span class="c1">#       before we turn them into frames_in_file )</span>
    <span class="c1"># get frames and info</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">load_frames</span><span class="p">(</span><span class="n">frame_in_file</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span>
                                     <span class="n">show_file_names</span><span class="o">=</span><span class="n">show_file_names</span><span class="p">,</span>
                                     <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">)</span>
    <span class="n">n_frames</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># get volume information</span>
    <span class="n">i_volume</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">volumes</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># you can use this method to load portions of the volumes, so fpv will be smaller</span>
    <span class="n">n_volumes</span><span class="p">,</span> <span class="n">fpv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i_volume</span><span class="p">),</span> <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="n">fpv</span><span class="p">),</span> <span class="s2">&quot;Can&#39;t have different number of frames per volume!&quot;</span>

    <span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_volumes</span><span class="p">,</span> <span class="n">fpv</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">frames</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="src.vodex.loaders.TiffLoader" class="doc doc-heading">
        <code>TiffLoader</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A class to work with tiff image files.
It is used to get the datatype of the images, get the number
of frames in each tiff file and load frames from tiff files.
You can create your own loaders to work with other file types.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_example</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>An example file file from the dataset
to infer the frame size and data type.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>frame_size</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td><p>individual frame size (hight, width).</p></td>
        </tr>
        <tr>
          <td><code>data_type</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.dtype">dtype</span></code>
          </td>
          <td><p>datatype.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>src\vodex\loaders.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TiffLoader</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to work with tiff image files.</span>
<span class="sd">    It is used to get the datatype of the images, get the number</span>
<span class="sd">    of frames in each tiff file and load frames from tiff files.</span>
<span class="sd">    You can create your own loaders to work with other file types.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_example: An example file file from the dataset</span>
<span class="sd">            to infer the frame size and data type.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        frame_size (Tuple[int,int]): individual frame size (hight, width).</span>
<span class="sd">        data_type (np.dtype): datatype.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_example</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frame_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame_size</span><span class="p">(</span><span class="n">file_example</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame_dtype</span><span class="p">(</span><span class="n">file_example</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TiffLoader</span><span class="p">):</span>
            <span class="n">same_fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_size</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">frame_size</span>
            <span class="n">same_dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">data_type</span>
            <span class="k">return</span> <span class="n">same_fs</span> <span class="ow">and</span> <span class="n">same_dt</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;__eq__ is Not Implemented for </span><span class="si">{</span><span class="n">TiffLoader</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frames_in_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute and return the number of frames in a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file: the name of a file relative to data_dir to get the number of frames for.</span>
<span class="sd">        Returns:</span>
<span class="sd">            the number of frames in the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO : try-catch here ?</span>
        <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
        <span class="c1"># not using metadata, since for some files it is corrupted for unknown reason ...</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">n_frames</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">n_frames</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_size</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets frame size ( height , width ) from a tiff file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file: the path to the file to get the size of the frame for.</span>
<span class="sd">        Returns:</span>
<span class="sd">            ( height , width ) height and width of an individual frame in pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO : try-catch here ?</span>
        <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
        <span class="c1"># not using metadate, since for some files it is corrupted for unknown reason ...</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_dtype</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the datatype of the frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            file: the path to the file to get the datatype of the frame for.</span>
<span class="sd">        Returns:</span>
<span class="sd">            datatype of the frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO : try-catch here ?</span>
        <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
        <span class="c1"># not using metadate, since for some files it is corrupted for unknown reason ...</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data_type</span>

    <span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                    <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load frames from files and return as an array (frame, y, x).</span>

<span class="sd">        Args:</span>
<span class="sd">            frames: list of frames inside corresponding files to load</span>
<span class="sd">            files: list of files corresponding to each frame</span>
<span class="sd">            show_file_names: whether to print the file from which the frames are loaded on the screen.</span>
<span class="sd">            show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">        Returns:</span>
<span class="sd">            3D array of requested frames (frame, y, x)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">print_file_name</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">show_file_names</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading from file:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">tif_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">show_file_names</span><span class="p">:</span>
            <span class="c1"># Setting show_progress to False, show_progress can&#39;t be True when show_file_names is True</span>
            <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
                <span class="n">show_progress</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hide_progress</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">show_progress</span>

        <span class="c1"># prepare an empty array:</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_size</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">),</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">)</span>

        <span class="c1"># initialise tif file and open the stack</span>
        <span class="n">tif_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">tif_file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">print_file_name</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">hide_progress</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;frames&#39;</span><span class="p">)):</span>
            <span class="c1"># check if the frame belongs to an opened file</span>
            <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">tif_file</span><span class="p">:</span>
                <span class="c1"># switch to a different file</span>
                <span class="n">tif_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">print_file_name</span><span class="p">()</span>
                <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">tif_file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">img</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">img</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.TiffLoader.get_frame_dtype" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frame_dtype</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets the datatype of the frame.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>the path to the file to get the datatype of the frame for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.dtype">dtype</span></code>
          </td>
          <td><p>datatype of the frame.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_frame_dtype</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the datatype of the frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: the path to the file to get the datatype of the frame for.</span>
<span class="sd">    Returns:</span>
<span class="sd">        datatype of the frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : try-catch here ?</span>
    <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
    <span class="c1"># not using metadate, since for some files it is corrupted for unknown reason ...</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">dtype</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data_type</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.TiffLoader.get_frame_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frame_size</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets frame size ( height , width ) from a tiff file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>the path to the file to get the size of the frame for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td><p>( height , width ) height and width of an individual frame in pixels.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_frame_size</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets frame size ( height , width ) from a tiff file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: the path to the file to get the size of the frame for.</span>
<span class="sd">    Returns:</span>
<span class="sd">        ( height , width ) height and width of an individual frame in pixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : try-catch here ?</span>
    <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
    <span class="c1"># not using metadate, since for some files it is corrupted for unknown reason ...</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.TiffLoader.get_frames_in_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_frames_in_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Compute and return the number of frames in a file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
          </td>
          <td><p>the name of a file relative to data_dir to get the number of frames for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td><p>the number of frames in the file.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_frames_in_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute and return the number of frames in a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        file: the name of a file relative to data_dir to get the number of frames for.</span>
<span class="sd">    Returns:</span>
<span class="sd">        the number of frames in the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO : try-catch here ?</span>
    <span class="c1"># setting multifile to false since sometimes there is a problem with the corrupted metadata</span>
    <span class="c1"># not using metadata, since for some files it is corrupted for unknown reason ...</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">n_frames</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="o">.</span><span class="n">pages</span><span class="p">)</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">n_frames</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="src.vodex.loaders.TiffLoader.load_frames" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">show_file_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Load frames from files and return as an array (frame, y, x).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>frames</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td><p>list of frames inside corresponding files to load</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>files</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[str], <span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]]</code>
          </td>
          <td><p>list of files corresponding to each frame</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>show_file_names</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to print the file from which the frames are loaded on the screen.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>show_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>whether to show the progress bar of how many frames have been loaded.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>3D array of requested frames (frame, y, x)</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>src\vodex\loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]],</span>
                <span class="n">show_file_names</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load frames from files and return as an array (frame, y, x).</span>

<span class="sd">    Args:</span>
<span class="sd">        frames: list of frames inside corresponding files to load</span>
<span class="sd">        files: list of files corresponding to each frame</span>
<span class="sd">        show_file_names: whether to print the file from which the frames are loaded on the screen.</span>
<span class="sd">        show_progress: whether to show the progress bar of how many frames have been loaded.</span>
<span class="sd">    Returns:</span>
<span class="sd">        3D array of requested frames (frame, y, x)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">print_file_name</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">show_file_names</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loading from file:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">tif_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_file_names</span><span class="p">:</span>
        <span class="c1"># Setting show_progress to False, show_progress can&#39;t be True when show_file_names is True</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="n">show_progress</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">hide_progress</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">show_progress</span>

    <span class="c1"># prepare an empty array:</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_size</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">),</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">)</span>

    <span class="c1"># initialise tif file and open the stack</span>
    <span class="n">tif_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">tif_file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">print_file_name</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="n">hide_progress</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;frames&#39;</span><span class="p">)):</span>
        <span class="c1"># check if the frame belongs to an opened file</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">tif_file</span><span class="p">:</span>
            <span class="c1"># switch to a different file</span>
            <span class="n">tif_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">print_file_name</span><span class="p">()</span>
            <span class="n">stack</span> <span class="o">=</span> <span class="n">TiffFile</span><span class="p">(</span><span class="n">tif_file</span><span class="p">,</span> <span class="n">_multifile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">img</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">img</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
