[tool.poetry]
name = "leximpact_prepare_data"
version = "0.0.34"
description = "Prepare data for LexImpact"
authors = ["LexImpact <leximpact@an.fr>"]
license = "AGPL-3.0"
readme = "README.md"
homepage = "https://leximpact.an.fr/"
repository = "https://git.leximpact.dev/leximpact/leximpact-prepare-data"


[tool.poetry.dependencies]
python = ">=3.9,<4.0"
leximpact-socio-fisca-simu-etat = "^0.1.2"
OpenFisca-France = "^113.0.4"
pandas = "^1.3.0"
typing-extensions = "^3.10.0"
# A list of all of the optional dependencies, some of which are included in the
# below `extras`. They can be opted into by apps.
scikit-learn = { version = "^1.0.1", extras = ["pipeline"]}
diagrams = { version = "^0.20.0", extras = ["pipeline"]}
vaex-core = { version = "^4.8.0", extras = ["pipeline"]}
tables = { version = "^3.6.1", extras = ["pipeline"]}
OpenFisca-Survey-Manager = {version = "0.46.13", extras = ["pipeline"]}
# OpenFisca-Survey-Manager = {git = "https://github.com/openfisca/openfisca-survey-manager.git", rev = "fix-ci-master", extras = ["pipeline"]}
# openfisca-france-reforms = {git = "https://git.leximpact.dev/openfisca/openfisca-france-reforms.git", tag = "1.0.42", extras = ["pipeline"]}

python-dotenv = {version = "^0.19.2", extras = ["pipeline"]}  # for vaex
#blake3 = { version = "0.2.1", extras = ["pipeline"]}  # for vaex : https://github.com/vaexio/vaex/issues/1817
vaex-server = "^0.8.1"
vaex-jupyter = "^0.7.0"
xarray = "2022.3.0"  # remove when https://github.com/pydata/xarray/issues/6818 is fixed or OpenFisca upgrade to numpy > 1.21
leximpact-aggregates = "^0.0.19"
OpenFisca-France-Data = "^0.21"
multipledispatch = "^0.6.0"
# nbdev = "2.2.10"  # Keep until https://github.com/fastai/nbdev/issues/1158
nbdev = "^2.2.10"
pyarrow = "6.0.1"  # Ugly fix for https://github.com/huggingface/datasets/issues/3310

[tool.poetry.dev-dependencies]
seaborn = "^0.11.1"
jupyter = "^1.0.0"
jupyterlab = "^3.2.8"
ipykernel = "^6.2.0"
lab = "^6.4"
pytest = "^5.2"
papermill = "^2.3.3"
plotly = "^5.4.0"
xlrd = "^2.0.1"  # For Excel
openpyxl = "^3.0.9"  # For Excel
nbdev = "^2.0.0"
# markupsafe = "2.0.1" # For NBDev : https://github.com/pallets/markupsafe/issues/284
pre-commit = "^2.17.0"
nbqa = ">=1.2.3"
flake8 = ">=3.9.0"
black = ">=21.5b1"
toml = "^0.10.2"

[tool.poetry.extras]
pipeline = ["scikit-learn", "diagrams", "vaex-core", "tables", "python-dotenv"]


[tool.black]
target-version = ['py38']
exclude = '''
/(
    \.git
  | __pycache__
  | \.tox
  | \.venv
  | build
  | dist
  | docs
  | notes
  | openfisca-france-data
)/
'''

[tool.isort]
profile = "black"
multi_line_output = 3
skip_glob = [ "docs" ]

[tool.ruff]
ignore = ["E501", "E402"]

[tool.nbqa.addopts]
ruff = [
"--extend-ignore=F405,F821,F403,F811"
]

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"
